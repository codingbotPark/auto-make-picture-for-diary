# auto-make-picture-for-diary
다이어리에 붙일 사진을 ppt에 하나하나 넣는 과정이 귀찮아서 만들기 시작

아는사람은 알지만 나는 아날로그 다이어리를 쓴다, 다이어리는 쓰면 다 좋다고 생각할거지만 좋은점은 하루로 보면 하루를 돌아볼 수 있고, 예전을 보면 예전에 내가 했던 것들을 보며 **특히 그 당시의 나의 생각과 느낌**을 생각할 수 있어서 좋은 것 같다,

굳이 아날로그를 쓰는 이유는 **사실 그냥 일기장을 산거긴 하지만*, 아날로그로 다이어를 썻을 때 더 프라이빗하고, 애정이 가는 느낌이다, 무엇보다 개발만하다보면 노트북만 계속하게 되는데 한 번씩 리프레시가 가능하다

좋은점은 더 말할 수 있지만 그만하겠다, **암튼! 나의 일기장에 조금 문제가 생겼다** 작년부터 써왔지만 요즘 초심을 잃어서 사진을 뽑아 붙이는게 귀찮아 졌다, **그렇게 하루하루 지나고 보니 반년이 지나서 이젠 손으로 못할 수준이 됐다**

엄 그래서 만들게 됐다, 그래도 한 번 만들면 앞으로 내 인생의 시간을 단축해줄거라 생각한다 드가자

## 1. `python-pptx` 설치(220712)
```
pip install python-pptx
```

pptx에서 파이썬의 ppt제어를 돕는다고 한다, 기본적으로 아래와 같이 설정했다

```py
from pptx import Presentation
from pptx.util import Inches

# ppt 열기
prs = Presentation()
# ppt 슬라이드 추가
slide = prs.slides.add_slide(prs.slide_layouts[6]) # 슬라이드 추가

# ppt저장 
prs.save('다이어리사진.pptx')
```

## 2. ppt에 넣을 사진의 경로 읽기
특정 경로의 폴더안에 있는 사진들을 다 ppt에 넣는 방식을 사용할 것이기 때문에 경로를 지정하고, 지정한 경로의 파일들을 읽는 코드를 작성한다

```py
print("사진이 있는 폴더 경로를 입력하세요 : ",end=" ")
path = input()
fileList = os.listdir(path)
```

`os` 라는 라이브러리를 활용해 폴더와 파일을 다룰 수 있다, 나는 os에 폴더 위치를 주면 안의 파일들을 알아내는 용도로 사용했다

### 3. ppt에 사진을 추가한다
위에서 추출한 파일들을 ppt에 삽입한다, 삽입 메소드는 `슬라이드.shapes.add_picture()` 함수를 사용해 넣을 수 있다

```py
# 매개변수는 각각 파일, left, top, width, height 이다
pic = slide.shapes.add_picture(path+"\\"+name,0,0,Inches(1.3)) # 3.3
```

> 명령어를 보면 width만 줬는데, width만 주면 height는 비율에 맞게 정해진다

위처럼 slide에 사진을 추가할 수 있다
요기까지는 구글링 했을 때 자료가 많아서 큰 문제없이 할 수 있었다

하지만 **이 땐 몰랐다 Inche를 사용하는게 나를 앞으로 어떻게 괴롭힐지!**, 분명 인치 말고 다른 방법이 있을거같다 내일 찾아보겠다

### 4. 사진 돌리기
ppt에 넣은 사진들을 프린팅해서 다이어리에 붙여야 하는데, 종이의 낭비를 줄이고 사진의 일관된 크기를 위해 비율에 따라 사진을 돌린다

위의 사진 추가 명령어를 보면 `width`와 `height` 를 메소드를 정하는데, **만약 세로가 더 긴 사진이라면90도 돌려줘야한다**

```py
width,height = pic.image.size # 사진 사이즈를 각각 width, height에 넣음

if (height > width):
    pic.rotation = 90 # 돌리기
    # 가로 세로를 변경해줘야 다음 위치를 정하기 쉽다
    width,height = height,width
```
> `rotation` 이라는 속성을 수정해서 쉽게 돌릴 수 있었다, 앞으로 더 계산이 필요할걸 생각해서 width와 height를 변경해줬다

### 5. 사진들의 사이즈 조절
내가 구글링을 잘 못해서 그런건진 몰라도 `python-pptx` 라이브러리 한국어 자료가 많이 없었던 것 같다, 그래서 "사진 사이즈 조절" 정도의 깊이만 들어가도 영문으로 검색해서 힌트를 얻을 수 있었다

그래도 `python-pptx` 가 꽤 직관적인 것 같아서 구글링에 없었던 내용이였는데, 아래처럼 사이즈를 조절할 수 있었다, 이게 됐을 때 뿌듯했다ㅋㅋㅋ

```py
pic = slide.shapes.add_picture(path+"\\"+name,0,0,Inches(1.3)) # 3.3
...
pic.height = Inches(1.3)
pic.width = round((Inches(1.3) * (width / height)))
```

아무튼 내가 해야됐던 것은 **평소 다이어리에 넣는 사이즈대로 3.3cm로 맞춰야 하는데, 정방형(3.3 X 3.3), 3대4(3이 3.3), 16대9(9가 3.3)의 사이즈로 맞춰야 했다** 그래서 위에서 돌린 요소는 가로 3.3 세로 3.3 으로 사진이 망가지기 때문에 다시 원래대로 돌리는 작업이다

![결과](https://user-images.githubusercontent.com/85085375/178494150-9407241e-2968-4380-86a3-e95bb405f0cc.png)

> 위처럼 이미지가 생기고, 사이즈 비율이 다 맞게 되있는 것을 확인할 수 있다, **또 사진 위치가 이상한 것도 확인할 수 있다ㅜㅜ**, 이렇게 python으로 진짜 ppt를 다룰 수 있는게 신기하다, 신기한만큼 나에게 익숙하지 않은 느낌이고 효율이 안 좋은 느낌이다

### 6. 인치 대신 사용하는 단위(220712)